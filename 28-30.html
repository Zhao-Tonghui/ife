<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="jquery-3.3.1.js"></script>
        <style type="text/css">
        .wrapper{
            width: 200px;
        }
        .wrapper input{
            width: inherit;
            padding: 1px;
            margin: 1px;
        }
        ul{
            padding: 0;
            margin: 0;
            border-right: 1px solid;
            border-left: 1px solid;
            border-bottom: 1px solid;
            visibility: hidden;
        }
        ul li{
            list-style: none;
        }
        </style>
    </head>
    <body>
        <div class="wrapper">
            <input id="email-input" type="text" />
            <ul id="email-sug-wrapper"></ul>
        </div>
         <script type="text/javascript">
        var emailInput=document.getElementById('email-input');
        var postfixList = ['163.com', 'gmail.com', '126.com', 'qq.com', '263.net'];
        var theUl=document.getElementById('email-sug-wrapper');
        var chooseIndex=0;

        window.onload=function(){
            emailInput.focus();
        }
        emailInput.onkeyup = function() {
    //获取用户输入，生成提示框中的提示内容，将提示内容添加到email-sug-wrapper中
    //控制email-sug-wrapper的显示/隐藏状态
            var gi=getInput();
            var sl=setLi(gi);
            controlVisibility(sl);
    }

        function getInput() {
            //获取用户输入
            //if 用户输入含有@ {用来拼接的用户输入内容 = 只使用@之前的字符串}
            var email=emailInput.conue.trim();
            return email; 
        }   

        function setLi(con) {
            //获取用户输入
            //遍历postfixList {
            //把用户输入和每一个postfix进行结合成为每一个Li
            //}
            //返回生成的提示内容
            for(let i=0;i<postfixList.length;i++){
                if(theUl.lastElementChild){
                    var del=theUl.lastElementChild;
                    theUl.removeChild(del);
                }
            }

            var ar=new Array();
            ar=con.split("");
            var special=con.indexOf("@");
            if(special>0){
                 for(let i=special;i<ar.length;i++){
                        ar.pop();
                }
            }
            con=ar.join("");

            var before="";
            var later;
            if(con.indexOf("@")!=-1){          // 存在@
                before=con.substr(0,con.indexOf("@"));
                later=con.substr(con.indexOf("@")+1,con.length-1);
            }
            if(later==undefined){
                before=con;
            }
            var count=0;
            for(let i in postfixList){
                if(postfixList[i].indexOf(later)==0){
                    var p=document.createElement('p');
                    p.innerHTML=before+"@"+postfixList[i];  
                    
                    ar.unshift(p.innerHTML);
                }else{
                    count++;
                }
            }
            if(count==postfixList.length){
                for(let j in postfixList){
                    var p=document.createElement('p');
                    p.innerHTML=before+"@"+postfixList[j];  
                    ar.unshift(p.innerHTML);
                }
            }
            return theList;
        }


            for(let i=0;i<postfixList.length;i++){
                if(con){
                var li=document.createElement('li');
                li.innerHTML=con+'@'+postfixList[i];
                theUl.appendChild(li);
                }
            }
            return theUl;
        }


        function controlVisibility(con) {
            if (getInput()=="") {
                 isHidden(con);
            } else {
                    isVisible(con);
                    }
        }

function isHidden(con) {
    con.style.visibility="hidden";
}

function isVisible(con) {
    con.style.visibility="visible";
}

    </script>
    </body>
</html>
